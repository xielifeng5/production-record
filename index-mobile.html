<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#4A5568">
    <meta name="description" content="æèŠ±ç»‡ç‰©ç”Ÿäº§è®°å½•ä¸ç®¡ç†ç³»ç»Ÿ">
    <title>æèŠ±ç»‡ç‰©ç”Ÿäº§è®°å½•ç³»ç»Ÿ</title>

    <!-- PWAé…ç½® -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">

    <!-- æ ¹æ®è®¾å¤‡è‡ªåŠ¨åŠ è½½æ ·å¼ -->
    <script>
        // æ£€æµ‹è®¾å¤‡ç±»å‹
        function detectDevice() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const userAgent = navigator.userAgent.toLowerCase();
            
            // iPad 12.9å¯¸æ£€æµ‹ (1024x1366 æˆ–æ›´å¤§)
            if ((width >= 1024 && height >= 1366) || (width >= 1366 && height >= 1024)) {
                return 'ipad';
            }
            // å…¶ä»–è®¾å¤‡ä½¿ç”¨æ‰‹æœºç‰ˆ
            return 'mobile';
        }
        
        // åŠ è½½å¯¹åº”æ ·å¼
        const device = detectDevice();
        const styleLink = document.createElement('link');
        styleLink.rel = 'stylesheet';
        styleLink.href = device === 'ipad' ? 'styles-ipad.css' : 'styles-mobile.css';
        document.head.appendChild(styleLink);
        
        console.log('æ£€æµ‹åˆ°è®¾å¤‡ç±»å‹:', device);
    </script>
</head>
<body>
    <div class="container">
        <!-- é¡µé¢å®¹å™¨ -->
        <div id="pagesContainer"></div>
        
        <!-- åº•éƒ¨æ“ä½œæ  -->
        <div class="bottom-actions">
            <button class="btn-primary" onclick="app.addPage()">â• å¢åŠ é¡µ</button>
            <button class="btn-success" onclick="app.saveAllPages()">ğŸ’¾ ä¿å­˜æ‰€æœ‰é¡µ</button>
            <button class="btn-secondary" onclick="app.showRecordsList()">ğŸ“‹ æŸ¥çœ‹å†å²</button>
        </div>
        
        <!-- å†å²è®°å½•åˆ—è¡¨ -->
        <div id="recordsList" style="display: none;">
            <div class="records-header">
                <h2>ğŸ“‹ å†å²è®°å½•</h2>
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="æœç´¢è®°å½•...">
                    <button onclick="app.searchRecords()">ğŸ”</button>
                </div>
                <div style="display: flex; gap: 8px; margin-top: 10px;">
                    <button class="btn-secondary" style="flex: 1;" onclick="app.showRecordForm()">â† è¿”å›</button>
                    <button class="btn-primary" style="flex: 1;" onclick="app.exportData()">ğŸ“¤ å¯¼å‡º</button>
                </div>
            </div>
            <div id="recordsContainer"></div>
        </div>
    </div>
    
    <!-- æ¨¡æ€æ¡† -->
    <div id="modal">
        <div class="modal-content">
            <div id="modalBody"></div>
        </div>
    </div>
    
	    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ -->
	    <input type="file" id="epImageInput" accept="image/*" style="display: none;">
	    <input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;">
	    <input type="file" id="videoInput" accept="video/*" capture="environment" style="display: none;">
	    <input type="file" id="audioInput" accept="audio/*" capture="microphone" style="display: none;">
    
    <!-- è„šæœ¬æ–‡ä»¶ -->
    <script src="database.js"></script>
    <script src="media.js"></script>
    <script src="app.js"></script>
    
	    <script>
	        // ç§»åŠ¨ç«¯é¢å¤–å¢å¼ºé€»è¾‘ï¼ˆApp å®ä¾‹åœ¨ app.js ä¸­å·²åˆ›å»ºä¸ºå…¨å±€å¸¸é‡ appï¼‰

	        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­ï¼ˆç²¾ç¡®åˆ°æ¨¡æ€æ¡†åŒºåŸŸï¼‰
	        document.getElementById('modal').addEventListener('click', function(e) {
	            if (e.target === this) {
	                app.closeModal();
	            }
	        });
	
	        // é˜²æ­¢é¡µé¢æ»šåŠ¨æ—¶çš„æ©¡çš®ç­‹æ•ˆæœï¼ˆiOSï¼‰
	        document.body.addEventListener('touchmove', function(e) {
	            if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
	                const scrollable = e.target.closest('.modal-content, #recordsContainer');
	                if (!scrollable) {
	                    e.preventDefault();
	                }
	            }
	        }, { passive: false });
	
	        // æ³¨å†ŒService Worker (PWAæ”¯æŒ)
	        if ('serviceWorker' in navigator) {
	            window.addEventListener('load', () => {
	                navigator.serviceWorker.register('./service-worker.js')
	                    .then(reg => console.log('âœ… Service Worker å·²æ³¨å†Œ'))
	                    .catch(err => console.log('âŒ Service Worker æ³¨å†Œå¤±è´¥:', err));
	            });
	        }
	
	        // æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯ï¼ˆè°ƒè¯•ç”¨ï¼‰
	        console.log('å±å¹•å°ºå¯¸:', window.innerWidth, 'x', window.innerHeight);
	        console.log('è®¾å¤‡åƒç´ æ¯”:', window.devicePixelRatio);
	    </script>
</body>
</html>

